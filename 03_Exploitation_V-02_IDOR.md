# Vulnerability V-02 â€” Insecure Direct Object Reference (IDOR)
Severity: **High**  
CWE: 639 / 285  
Status: Confirmed  
Endpoint: `/customer/confirm.php?order_id=*`

---

## 1. Deskripsi
Endpoint `order_id` dapat dimanipulasi langsung oleh user biasa untuk mengakses data
pembelian milik user lain. Sistem tidak melakukan verifikasi bahwa order tersebut benar milik
akun yang sedang login.

Ini memungkinkan attacker melihat:
- nilai pembayaran,
- waktu order dibuat,
- nomor invoice,
- status order milik user lain.

---

## 2. Bukti (Sanitized)
- User biasa mengakses menu **My Orders**.
- Tombol "Confirm Payment" mengarah ke URL dengan parameter `order_id`.
- Mengganti nilai `order_id` ke angka lain menampilkan order milik user lain.
- Tidak ada validasi kepemilikan order.

Bukti disimpan pada:
`technical_appendix/exploits/V-02/idor_sanitized.png`

---

## 3. Dampak
- Kebocoran informasi pribadi pelanggan.
- Potensi fraud (attacker dapat melakukan konfirmasi palsu).
- Enumeration terhadap order lain.
- Pelanggaran privasi tingkat tinggi.

---

## 4. Rekomendasi
- Validasi bahwa order_id harus milik session user saat ini.
- Ambil data order berdasarkan **session**, bukan parameter URL.
- Gunakan UUID acak sebagai ID, bukan integer berurutan.
